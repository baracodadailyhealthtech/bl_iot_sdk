

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Low_Power_Mode_BL702L &mdash; BL IoT SDK release_bl_iot_sdk_1.6.40-1554-g971a32c6a 文档</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="author" title="关于这些文档"
              href="../../../about.html"/>
        <link rel="index" title="索引"
              href="../../../genindex.html"/>
        <link rel="search" title="搜索" href="../../../search.html"/>
    <link rel="top" title="BL IoT SDK release_bl_iot_sdk_1.6.40-1554-g971a32c6a 文档" href="../../../index.html"/>
        <link rel="up" title="BLE" href="../index.html"/>
        <link rel="next" title="BL702L_Ble_Remote_Control_Demo" href="../demo_ble_rc/ble_rc.html"/>
        <link rel="prev" title="Ble Introduction" href="../demo_ble/ble.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> BL IoT SDK
          

          
            
            <img src="../../../_static/Bouffalolab-logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                release_bl_iot_sdk_1.6.40-1554-g971a32c6a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/index_702.html">702快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/index_702L.html">702L快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api-reference/index.html">API 参考</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Example</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">BLE</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../demo_ble/ble.html">Introduction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Low_Power_Mode_BL702L</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#low-power-mode">Low Power Mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../demo_ble_rc/ble_rc.html">Remote_Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../demo_mesh/mesh.html">Mesh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../zigbee/index.html">Zigbee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../network/index.html">Ethernet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Components/index.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../QA/index.html">QA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hw-reference/index.html">H/W 参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resources.html">相关资源</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">BL IoT SDK</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Example</a> &raquo;</li>
        
          <li><a href="../index.html">BLE</a> &raquo;</li>
        
      <li>Low_Power_Mode_BL702L</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/Examples/ble/demo_low_power_mode/low_power_mode.rst.txt" rel="nofollow"> 查看页面源码</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="low-power-mode-bl702l">
<span id="ble-index"></span><h1>Low_Power_Mode_BL702L<a class="headerlink" href="#low-power-mode-bl702l" title="永久链接至标题"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="永久链接至标题"></a></h2>
<p>This example mainly intoduces how to use ble low power mode.</p>
</section>
<section id="low-power-mode">
<h2>Low Power Mode<a class="headerlink" href="#low-power-mode" title="永久链接至标题"></a></h2>
<ul>
<li><p>Low Power Flow</p>
<p>System low power mode is called PDS (Power Down Sleep).
Freertos is used in SDK. In Freertos’ idle task, it checks whether BL702L device can enter into low power mode or not.</p>
<ol class="arabic simple">
<li><p>If Freertos can sleep, then check whether BLE can sleep. If BLE cannot sleep, BL702L will not enter into low power mode. If BLE can sleep, obtain BLE’s sleep duration.</p></li>
<li><p>The final sleep duration of BL702L is the minimum value between Freertos’ idle duration and BLE’s idle duration. If the final sleep duration is smaller than  a threshold such as 5ms, then BL702L will not enter into low power mode.</p></li>
</ol>
<blockquote>
<div><p>If BLE’s idle duration is greater than Freertos’ idle duration, ble is still in sleep mode when BL702L wake up. In this case, ble will wake up in below two cases.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>BLE’s sleep duration is over.</p></li>
<li><p>BLE is woken up by software if some ble actions such as advertising will be triggered by application.</p></li>
</ol>
</div></blockquote>
<p>If BLE’s idle duration is smaller than (or is equal to) Freertos’ idle duration, BLE will wake up after BL702L wake up from system low power mode.</p>
</div></blockquote>
</li>
<li><p>Low Power API</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">btble_pds_enable</span> <span class="pre">(uint8_t</span> <span class="pre">enable)</span></code></p></li>
</ol>
<blockquote>
<div><p>This API is used to enable or disable low power feature.</p>
<p>In which,</p>
<p>enable=1, enable low power. BL702L will enter into low power mode in idle state.</p>
<p>enable=0, disable low power. BL702L will not enter into low power mode.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">btble_set_before_sleep_callback</span> <span class="pre">(btble_before_sleep_cb_t</span> <span class="pre">cb)</span></code></p></li>
</ol>
<blockquote>
<div><p>If application layer needs to do something before Ble enters into sleep, please call this API to register the callback function. Ble may not be able to sleep at that time while application layer has done something in this callback function, application can handle this case in the callback function registered by btble_set_sleep_aborted_callback.</p>
<p>For example, application layer uses key scan feature, key scan interrupt shall be disabled in the callback function registered by btble_set_before_sleep_callback. Ble may not go to sleep because sleep conditions are not met at that time, then application can enable key scan interrupt in the callback function set by btble_set_sleep_aborted_callback.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">btble_set_sleep_aborted_callback</span> <span class="pre">(btble_sleep_aborted_cb_t</span> <span class="pre">cb)</span></code></p></li>
</ol>
<blockquote>
<div><p>In Freertos idle task, when BL702L cannot enter into low power mode, the callback function registered by btble_set_sleep_aborted_callback will be called.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">btble_set_after_sleep_callback</span> <span class="pre">(btble_after_sleep_cb_t</span> <span class="pre">cb)</span></code></p></li>
</ol>
<blockquote>
<div><p>After BL702L wake up, the callback function registered by this API will be called. If application layer needs to do something after BL702L wakes up, please use this api to register the callback function.</p>
<p>For example, if application layer use key scan feature, it shall recover key scan configuration in this callback function because key scan configuration is dropped in low power mode.</p>
</div></blockquote>
</li>
<li><p>How to measure current and average power consumption</p>
<blockquote>
<div><figure class="align-default">
<img alt="" src="../../../_images/image110.png" />
</figure>
</div></blockquote>
<p>Refer to the above schematic diagram,</p>
<p>1.When using a multimeter to measure current, connect the positive pole of the multimeter to <code class="docutils literal notranslate"><span class="pre">VDD33</span></code> on <code class="docutils literal notranslate"><span class="pre">J2</span></code> , and connect the negative pole of the multimeter to <code class="docutils literal notranslate"><span class="pre">VDD33_MOD</span></code> on <code class="docutils literal notranslate"><span class="pre">J2</span></code> .</p>
<p>2.When using the power monitor to measure average power consumption, the development board is generally powered through the power monitor. The positive pole of the power monitor is connected to <code class="docutils literal notranslate"><span class="pre">VDD33_MOD</span></code> on <code class="docutils literal notranslate"><span class="pre">J2</span></code> , and the negative pole of the power monitor is connected to <code class="docutils literal notranslate"><span class="pre">GND</span></code> on <code class="docutils literal notranslate"><span class="pre">J2</span></code> .</p>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../demo_ble_rc/ble_rc.html" class="btn btn-neutral float-right" title="BL702L_Ble_Remote_Control_Demo" accesskey="n">下一页 <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../demo_ble/ble.html" class="btn btn-neutral" title="Ble Introduction" accesskey="p"><span class="fa fa-arrow-circle-left"></span> 上一页</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Bouffalo Lab.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Stanford-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'release_bl_iot_sdk_1.6.40-1554-g971a32c6a',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>